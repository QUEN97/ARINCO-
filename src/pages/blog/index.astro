---
import Layout from '../../layouts/Layout.astro';
import BlogCard from '../../components/BlogCard.astro';
import { getCollection } from 'astro:content';

// Obtener y preparar los posts
const allPosts = await getCollection('blog');
const posts = allPosts
  .sort((a: any, b: any) => b.data.date.getTime() - a.data.date.getTime())
  .map((post: any) => ({
    ...post,
    ...post.data, // Aplanamos la estructura
    slug: post.slug
  }));
---

<Layout>
  <section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
      <!-- Encabezado del blog -->
      <div class="text-center mb-12">
        <span class="text-primary font-semibold tracking-widest uppercase">Conocimiento</span>
        <h1 class="text-4xl font-bold text-dark mt-4 mb-6">Nuestro Blog</h1>
        <div class="w-20 h-1 bg-primary mx-auto"></div>
      </div>

      <!-- Grid de artículos -->
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {posts.map((post) => (
          <BlogCard blog={post} />
        ))}
      </div>

      <!-- Botón de ver más (opcional) -->
      {posts.length > 6 && (
        <div class="text-center mt-12">
          <a
            href="/blog"
            class="inline-flex items-center bg-primary hover:bg-primary-dark text-white font-bold py-3 px-6 rounded-lg transition-colors duration-300 shadow-md hover:shadow-lg"
          >
            Ver más artículos
            <svg
              class="w-5 h-5 ml-2 transition-transform hover:translate-x-1"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5l7 7-7 7"></path>
            </svg>
          </a>
        </div>
      )}
    </div>
  </section>
</Layout>